<extend  name="Public/base"/>
<block name="body">
    <link href="__STATIC__/lhgdar/_doc/prettify/prettify.css" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src="__STATIC__/lhgdar/lhgcore.lhgcalendar.min.js"></script>
    <div class="main-title">
        <h2>编辑促销规则列表</h2>
    </div>
    <form action="{:U('eidt')}" method="post" class="form-horizontal">
        <input type="hidden" name="promotion_id" value="{$list.promotion_id}">
        <div class="form-group"  >

            <label class="col-sm-2 control-label">商家：</label>

            <div class="col-sm-3">

                <select class="form-control" name="store_id">
                    <if condition="$name eq ''">
                        <option value="">请选择店铺</option>
                        <else/>
                        <option value="{$id}" style="display: none">{$name}</option>
                    </if>
                    <volist name="store" id="vo">
                        <option value="{$vo.store_id}">{$vo.store_name}</option>
                    </volist>
                </select>

            </div>

        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">促销标题：</label>
            <div class="col-sm-3">
                <textarea name="promotion_name" rows="4" placeholder="促销标题" class="form-control" >{$list.promotion_name}</textarea>
            </div>
            <label style="padding-top:7px;font-weight:normal;">（必填）</label>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单总金额限制：</label>
            <div class="col-sm-1">
                <input type="text" class="form-control" name="promotion_money" value="{$list.promotion_money}">
            </div>
            <label style="padding-top: 7px;font-weight: normal;">（必填）</label>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">具体时间：</label>
            <div class="col-sm-5" style="width: 500px;">
                <div class="radio">
                    <label><input type="radio" name="promotion_time" value="0" <eq name="list.promotion_time" value="0">checked</eq> >不限制</label>
                    <label style="margin-left: 30px;"><input type="radio" name="promotion_time"  value="1" <eq name="list.promotion_time" value="1">checked</eq>>每周星期</label>
                    <label style="margin-left: 30px;"><input type="radio" name="promotion_time"  value="2" <eq name="list.promotion_time" value="2">checked</eq>>每天时间段</label>
                </div>
            </div>
        </div>
        <div class="form-group dnf"></div>
        <div class="form-group">
            <label class="col-sm-2 control-label">支付方式：</label>
            <div class="col-sm-3">
                <div class="radio">
                    <label><input type="radio" name="payment" value="0" checked="checked" <eq name="list.payment" value="0">checked</eq>>无限制</label>
                    <label><input type="radio" name="payment" value="1" <eq name="list.payment" value="1">checked</eq>>在线支付</label>
                    <label><input type="radio" name="payment" value="2" <eq name="list.payment" value="2">checked</eq>>货到付款</label>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class='col-sm-2 control-label'>促销类型：</label>
            <div class='col-sm-2'>
                <select class='form-control' name="promotion_type">
                    <option value='0' <eq name="list.promotion_type" value="0">selected</eq>>送赠品</option>
                    <option value='1' <eq name="list.promotion_type" value="1">selected</eq>>减费用</option>
                    <option value='2' <eq name="list.promotion_type" value="2">selected</eq>>折扣</option>
                    <option value='4' <eq name="list.promotion_type" value="4">selected</eq>>满立减</option>
                    <option value='3' <eq name="list.promotion_type" value="3">selected</eq>>免费配送</option>
                </select>
            </div>
        </div>
        <div class="form-group zpmc"></div>
        <div class='form-group cpsl'></div>
        <div class="form-group">
            <label class='col-sm-2 control-label'>生效时间：</label>
            <div class='col-sm-2'>
                <div style='float: left; margin-top: 5px;'>从</div>
                <div style='float: left;margin-left: 13px'><input type='text' class='form-control' name='effective_date' value="{$list.effective_date|date='Y-m-d',###}" id='demo_inp1'></div></div>
            <div class='col-sm-2'><div style='float: left; margin-top: 5px; margin-left: -28px;'>至</div>
                <div style='float: left; margin-left: -0px;'><input type='text' class='form-control' name='termination_date' value="{$list.termination_date|date='Y-m-d',###}" id='demo_inp2'></div></div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">促销标签：</label>
            <div class="col-sm-2">
                <input type="text" class="form-control" name="promotional_labels" value="{$list.promotional_labels}">

                <!--<div class="radio">-->
                <!--<label><input type="radio" name="promotional_labels" value="1">在线支付</label>-->
                <!--<label><input type="radio" name="promotional_labels" value="2">减</label>-->
                <!--<label><input type="radio" name="promotional_labels" value="3">赠可乐</label>-->
                <!--<label><input type="radio" name="promotional_labels" value="4">招牌菜</label>-->
                <!--</div>-->
            </div>
            <label style="padding-top: 7px;font-weight: normal">例如：首、减</label>
        </div>



        <div class="form-group">
            <label class='col-sm-2 control-label'>首次下单是否叠加：</label>
            <div class='col-sm-3'>
                <div class='radio'><label>
                    <input type='radio' name='first_order'  value='1' <eq name='list.first_order' value='1'>checked</eq>>开</label>
                    <label>
                        <input type='radio' name='first_order' value='2' <eq name='list.first_order' value='2'>checked</eq> >关
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group lijian" style="display: none">
            <label class="col-sm-2 control-label">立减：</label>
            <div class="col-sm-1">
                <input type="text" class="form-control" name="vertical" value="{$list.vertical}">
            </div>
            <label style="padding-top: 7px; font-weight: normal">(元)</label>
        </div>
        <div class='form-group'><label class='col-sm-2 control-label'>是否启用：</label>
            <div class='col-sm-3'>
                <div class='radio'><label>
                    <input type='radio' name='state'  value='0' <eq name='list.state' value='0'>checked</eq>>启用</label>
                    <label>
                        <input type='radio' name='state' value='1' <eq name='list.state' value='1'>checked</eq> >未启用
                    </label>
                </div>
            </div>
        </div>
        <div class="form-group" style="margin-top: 50px">
            <label class="col-sm-2 control-label" >&nbsp;</label>
            <div class="col-sm-4">
                <button type="submit" id="submit" class="btn submit-btn ajax-post" target-form="form-horizontal">保  存</button>
                <button class="btn btn-return" onclick="history.back(-1);return false;">取 消</button>
            </div>
        </div>
    </form>
</block>
<block name="script">
    <script type="text/javascript">
        $(document).ready(function(){
            if("{$list.promotion_time}" == 1){
                $('.dnf').html("<label class='col-sm-2 control-label'>请选择日期：</label>" +
                        "<div class='col-sm-5'><div class='checkbox'>"+
                        "<label><input type='checkbox' name='time_quantum[]' value='1' <eq name='list[0][0]' value='1'>checked</eq>>星期一</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='2' <eq name='list[0][1]' value='2'>checked</eq>>星期二</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='3' <eq name='list[0][2]' value='3'>checked</eq>>星期三</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='4' <eq name='list[0][3]' value='4'>checked</eq>>星期四</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='5' <eq name='list[0][4]' value='5'>checked</eq>>星期五</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='6' <eq name='list[0][5]' value='6'>checked</eq>>星期六</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='7' <eq name='list[0][6]' value='7'>checked</eq>>星期日</label></div></div>")
            }else if("{$list.promotion_time}" == 2){
                $('.dnf').html("<label class='col-sm-2 control-label'>时间段：</label>" +
                        "<div class='col-sm-3'><div style='float: left;margin-top: 7px'>从</div><div style='float: left;margin-left: 10px'><input type='text' class='form-control' name='time_quantum[]' style='width:85px' value='{$list[0][0]}'></div><div/>" +
                        "<div class='col-sm-3' style='width: 150px'><div style='float: left;margin-top: 7px'>至</div><div style='float: right;'><input type='text' class='form-control' name='time_quantum[]' style='width:85px' value='{$list[0][1]}'></div><div/>" +
                        "<div style='width: 500px;margin: 50px 0 0 0;margin-left: -100px'>例如：从08:00至11:00 增加时间段</div>")
            }else{
                $('.dnf').html("");
            }
            if("{$list.promotion_type}" == 0){
                $('.zpmc').html("<label class='col-sm-2 control-label'>赠品名称：</label><div class='col-sm-2'><input type='text' class='form-control' name='present_name' value='{$list.present_name}'></div>");
                $('.cpsl').html("<label class='col-sm-2 control-label'>赠品数量：</label><div class='col-sm-1'> <input type='text' class='form-control' name='present_numbe' value='{$list.present_numbe}'></div><label style='padding-top: 7px;font-weight: normal;'>（请录入赠品库存数量）</label>");
            }else if("{$list.promotion_type}" == 1){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>减费用金额：</label><div class='col-sm-1'><input type='text' class='form-control' name='reduction' value='{$list.reduction}'></div>")
            }else if("{$list.promotion_type}" == 2){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>折扣：</label><div class='col-sm-1'><input type='text' class='form-control' name='discount' value='{$list.discount}'></div><label style='padding-top: 7px;font-weight: normal;'>假如9折请录入90</label>")
            }else if("{$list.promotion_type}" == 4){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>满立减：</label><div class='col-sm-2'><input type='text' class='form-control' name='jian' value='{$list.jian}'></div><label style='padding-top: 7px;font-weight: normal'>例如：满50减10：100-50,50-10从大到小依次录入,多个请用逗号隔开</label>")
            }else{
                $('.zpmc').html("");$('.cpsl').html("");
            }
            $('#demo_inp1').calendar({ format:'yyyy-MM-dd HH:mm:ss' });
            $('#demo_inp2').calendar({ format:'yyyy-MM-dd HH:mm:ss' });
            $('#img').calendar({ id:'#cal3' });
            if("{$list['first_order']}" == 1){
                $('.lijian').show();
            }else{
                $('.lijian').hide();
            }
        });
        $("input[name='promotion_time']").bind("click",function(){
            var time = $(this).val();
            if(time == 1){
                $('.dnf').html("<label class='col-sm-2 control-label'>请选择日期：</label>" +
                        "<div class='col-sm-5'><div class='checkbox'>"+
                        "<label><input type='checkbox' name='time_quantum[]' value='1' <eq name='list[0][0]' value='1'>checked</eq>>星期一</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='2' <eq name='list[0][1]' value='2'>checked</eq>>星期二</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='3' <eq name='list[0][2]' value='3'>checked</eq>>星期三</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='4' <eq name='list[0][3]' value='4'>checked</eq>>星期四</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='5' <eq name='list[0][4]' value='5'>checked</eq>>星期五</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='6' <eq name='list[0][5]' value='6'>checked</eq>>星期六</label>" +
                        "<label><input type='checkbox' name='time_quantum[]' value='7' <eq name='list[0][6]' value='7'>checked</eq>>星期日</label></div></div>")
            }else if(time == 2){
                $('.dnf').html("<label class='col-sm-2 control-label'>时间段：</label>" +
                        "<div class='col-sm-3'><div style='float: left;margin-top: 7px'>从</div><div style='float: left;margin-left: 10px'><input type='text' class='form-control' name='time_quantum[]' style='width:85px' value='{$list[0][0]}'></div><div/>" +
                        "<div class='col-sm-3' style='width: 150px'><div style='float: left;margin-top: 7px'>至</div><div style='float: right;'><input type='text' class='form-control' name='time_quantum[]' style='width:85px' value='{$list[0][1]}'></div><div/>" +
                        "<div style='width: 500px;margin: 50px 0 0 0;margin-left: -100px'>例如：从08:00至11:00 增加时间段</div>")
            }else{
                $('.dnf').html("");
            }
        });
        $("select").change(function() {
            var option = $(this).find("option:checked").attr("value");
            if(option == 1){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>减费用金额：</label><div class='col-sm-1'><input type='text' class='form-control' name='reduction' value='{$list.reduction}'></div>")
            }else if(option == 2){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>折扣：</label><div class='col-sm-1'><input type='text' class='form-control' name='discount' value='{$list.discount}'></div><label style='padding-top: 7px;font-weight: normal;'>假如9折请录入90</label>")
            }else if(option == 3){
                $('.zpmc').html("");$('.cpsl').html("");
            }else if(option == 4){
                $('.cpsl').html("");
                $('.zpmc').html("<label class='col-sm-2 control-label'>满立减：</label><div class='col-sm-2'><input type='text' class='form-control' name='jian' value='{$list.jian}'></div><label style='padding-top: 7px;font-weight: normal'>例如：满50减10：100-50,50-10从大到小依次录入,多个请用逗号隔开</label>")
            }else{
                $('.zpmc').html("<label class='col-sm-2 control-label'>赠品名称：</label><div class='col-sm-2'><input type='text' class='form-control' name='present_name' value='{$list.present_name}'></div>");
                $('.cpsl').html("<label class='col-sm-2 control-label'>赠品数量：</label><div class='col-sm-1'> <input type='text' class='form-control' name='present_numbe' value='{$list.present_numbe}'></div><label style='padding-top: 7px;font-weight: normal;'>（请录入赠品库存数量）</label>");
            }

        });

        $("input[name='first_order']").click(function(){
            var  id = $(this).val();
            if(id == 1){
                $('.lijian').show();
            }else{
                $('.lijian').hide();
            }
        })
    </script>
</block>