<?php/** * Created by PhpStorm. * Auther: <zhangpf41@163.com> * Date: 2015/6/4 * Time: 16:42 */namespace  Org\Sms;class Sms{    static public function sendSms($uid,$password,$phone,$code){        //$phone=I('get.phone');        $uid=$uid;        $password=$password;        //$code=$this->generateCode();        session('mobilecode',null);        session('mobilecode',$code);        $content=iconv('UTF-8','GB2312','您的验证码是:').$code.iconv('UTF-8','GB2312',',请在5分钟内正确输入。');        $url="http://service.winic.org/sys_port/gateway/?id=".$uid."&pwd=".$password."&to=".$phone."&content=".$content."&time=";        $res=static::httpGet($url);        return $res;    }    public function sendCode(){        $phone=I('get.userphone');        $uid="gjz1010";        $password="rundasoft";        $code=$this->generateCode();        session('mobilecode',null);        session('mobilecode',$code);        $content=iconv('UTF-8','GB2312','您的验证码是').$code.iconv('UTF-8','GB2312','，在5分钟内有效。如非本人操作请忽略此短信。');        $url="http://service.winic.org/sys_port/gateway/?id=".$uid."&pwd=".$password."&to=".$phone."&content=".$content."&time=";        $res=self::httpGet($url);        $this->ajaxReturn($res);    }    //随机生成验证码    private  function generateCode($length = 6) {        return rand(pow(10,($length-1)), pow(10,$length)-1);    }    /*     * GET 请求     *     * @param string $url     */    static public function httpGet($url) {        $oCurl = curl_init ();        if (stripos ( $url, "https://" ) !== FALSE) {            curl_setopt ( $oCurl, CURLOPT_SSL_VERIFYPEER, FALSE );            curl_setopt ( $oCurl, CURLOPT_SSL_VERIFYHOST, FALSE );        }        curl_setopt ( $oCurl, CURLOPT_URL, $url );        curl_setopt ( $oCurl, CURLOPT_RETURNTRANSFER, 1 );        $sContent = curl_exec ( $oCurl );        $aStatus = curl_getinfo ( $oCurl );        curl_close ( $oCurl );        if (intval ( $aStatus ["http_code"] ) == 200) {            return $sContent;        } else {            return false;        }    }}