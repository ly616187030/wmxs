<?phpnamespace Home\Controller;use User\Api\UserApi;class AccountController extends HomeController {    function _initialize(){        parent::_initialize();        $this->assign('_controller',CONTROLLER_NAME);    }    public function Index(){        $this->login();        $this->assign("meta_title","账户设置");        $this->assign('is_login',is_login());        $this->display();    }    public function Edit(){        $this->login();        $uid = is_login();        $usertable = M("ucenter_member");        $table = M("member");        $c = M("Address_province");        $list = $c->select();        $userdata = $usertable->where("id=$uid")->find();        $data = $table->where("uid=$uid")->find();        $this->assign("meta_title","基本账户信息");        $this->assign("nowuser",$userdata);        $this->assign("now",$data);        $this->assign("list",$list);        $this->assign('is_login',is_login());        $this->display();    }    public function Repass(){        $this->assign("meta_title","修改密码");        $this->assign('is_login',is_login());        $this->display();    }    public function Subpass(){        if ( IS_POST ) {            //获取参数            $uid        =   is_login();            $password   =   I('post.old');            $repassword = I('post.repassword');            $data['password'] = I('post.password');            empty($password) && $this->error('请输入原密码');            empty($data['password']) && $this->error('请输入新密码');            empty($repassword) && $this->error('请输入确认密码');            if($data['password'] !== $repassword){                $this->error('您输入的新密码与确认密码不一致');            }            $Api = new UserApi();            $res = $Api->updateInfo($uid, $password, $data);            if($res['status']){                $this->success('修改密码成功！');            }else{                $this->error($res['info']);            }        }    }    public function Getcity(){        $suggest = I("post.suggest");        $c = M("Address_city");        $list = $c->where('provincecode = '.$suggest)->select();        $this->ajaxReturn($list);    }    public function Gettown(){        $suggest = I("post.suggest");        $c = M("Address_town");        $list = $c->where("citycode = ".$suggest)->select();        $this->ajaxReturn($list);    }    //接收用户设置的表单数据    public function PostInfo(){        $member = M('member');        $uid = is_login();        if( IS_POST ){            $data = I('post.');            $birthY = $data['birthY'];            $birthM = $data['birthM'];            $birthD = $data['birthD'];            $data['birthday'] = $birthY."-".$birthM."-".$birthD;            $re = $member->where("uid = ".$uid)->save($data);            if($re){                $this->success("修改成功");            }else{                $this->error("修改失败");            }        }    }    public function phoneBound(){        if(IS_POST){            $user = M('ucenter_member');            $uid = is_login();            $data = I('post.');            $code = session('mobilecode');            if($data['yzm'] == $code){                $re = $user->where("id=$uid")->save($data);                if($re){                    $this->success('绑定成功');                }else{                    $this->error('提交失败，请确认是否已绑定手机');                }            }else{                $this->error('验证码错误');            }        }else{            $this->assign('is_login',is_login());            $this->display();        }    }}